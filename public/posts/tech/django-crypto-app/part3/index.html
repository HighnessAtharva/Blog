<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Django Crypto App Part 3 | Atharva Shah</title>
<meta name="keywords" content="django, python">
<meta name="description" content="Functional requirements of what we are building, the approach, the high-level design and the project setup using Django.">
<meta name="author" content="">
<link rel="canonical" href="https://atharvashah.netlify.app/posts/tech/django-crypto-app/part3/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.20bcbd30136eb7369c962bcab4266306b61384f3d171e085d6feae3e64376a84.css" integrity="sha256-ILy9MBNutzaclivKtCZjBrYThPPRceCF1v6uPmQ3aoQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://atharvashah.netlify.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://atharvashah.netlify.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://atharvashah.netlify.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://atharvashah.netlify.app/apple-touch-icon.png">
<link rel="mask-icon" href="https://atharvashah.netlify.app/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js"></script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-7YWY1F15R3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7YWY1F15R3');
</script>

<script async src="https://fundingchoicesmessages.google.com/i/pub-9913536001930134?ers=1" nonce="PtBXb_v6sVZIafilpE5Kzg"></script><script nonce="PtBXb_v6sVZIafilpE5Kzg">(function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();</script>


<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9913536001930134" crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7YWY1F15R3"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-7YWY1F15R3', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Django Crypto App Part 3" />
<meta property="og:description" content="Functional requirements of what we are building, the approach, the high-level design and the project setup using Django." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://atharvashah.netlify.app/posts/tech/django-crypto-app/part3/" />
<meta property="og:image" content="https://atharvashah.netlify.app/blog/django-crypto-app/cover-3.webp" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-05-01T23:20:34+05:30" />
<meta property="article:modified_time" content="2023-05-01T23:20:34+05:30" /><meta property="og:site_name" content="Atharva Shah" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://atharvashah.netlify.app/blog/django-crypto-app/cover-3.webp" />
<meta name="twitter:title" content="Django Crypto App Part 3"/>
<meta name="twitter:description" content="Functional requirements of what we are building, the approach, the high-level design and the project setup using Django."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "📚 All Posts",
      "item": "https://atharvashah.netlify.app/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "💻Tech",
      "item": "https://atharvashah.netlify.app/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Django Crypto App Part 3",
      "item": "https://atharvashah.netlify.app/posts/tech/django-crypto-app/part3/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Django Crypto App Part 3",
  "name": "Django Crypto App Part 3",
  "description": "Functional requirements of what we are building, the approach, the high-level design and the project setup using Django.",
  "keywords": [
    "django", "python"
  ],
  "articleBody": "Introduction Welcome to the final part of the 3-part technical tutorial series, where have been building a Django project that enables users to manage their cryptocurrency portfolios. To implement the functionalities and additional features, we’ll be utilizing API calls to coingecko or any other cryptocurrency API.\nWant to start from the beginning? Read Part 1\nIn the first part, we set up the project and created the models. In the second part continued off from that point and added all the templates, views and urls and code up the entire crypto project. So, if you haven’t read the previous parts, I highly recommend you to do so before continuing with this part. Here, we will exclusively discuss testing approach by writing test cases for Models, Views and Templates using Pytest. We will also write a ton of tests to ensure that our code is working as expected and generate a coverage report to see how much of our code is covered by the tests.\nThe code for the entirety of the project can be found here -\u003e Github Repo for Django Crypto App\nTesting is an important part of software development. It helps us to ensure that our code is working as expected and also helps us to catch bugs early on. It also helps us to ensure that our code is maintainable and readable. So, let’s get started.\nTest Driven Development Explained In Django, automated testing can be performed at three levels: URL testing, model testing, and view testing.\nURL Testing URL testing in Django is used to check if the endpoints specified in the URL patterns are correctly configured and pointing to the appropriate views. This is important because if an endpoint is incorrect or pointing to the wrong view, the application will not be able to process the request, leading to errors or incorrect behavior. URL testing is typically performed using the Django Client class, which simulates a web client and allows the developer to send requests to the application.\nModel Testing Model testing in Django is used to check if the data stored in the database matches the expected schema and constraints specified in the models.py file. It helps ensure that the application is storing and retrieving data correctly and that the database is working as expected. Model testing is typically performed using the Django TestCase class and its various assertion methods, which allow the developer to create test data, save it to the database, and verify that the data has been saved correctly.\nMaster Database Queries in Django with 40 Django ORM Exercises\nView Testing View testing in Django is used to check if the business logic defined in the views.py file is functioning correctly. It is used to test whether the views are handling requests as expected and returning the appropriate responses. View testing is typically performed using the Django TestCase class and its various assertion methods, which allow the developer to simulate requests and verify the responses.\nFor this crypto-wallet app, I used all three types of automated testing. For URL testing, I created a series of test cases that used the Django Client class to simulate requests to various endpoints in the application. Each test case sent a request to the endpoint and verified that the response was the expected template.\nFor model testing, I created a series of test cases that used the Django TestCase class to create test data, save it to the database, and verify that it had been saved correctly. Each test case tested a specific model or relationship between models to ensure that the data was being stored and retrieved correctly.\nFor view testing, I created a series of test cases that used the Django TestCase class to simulate requests to various views in the application. Each test case sent a request to the view and verified that the response was the expected result.\nWriting Tests Go to the tests.py file in the mainapp folder and add the following imports since we will be using them in our tests.\nfrom decimal import Decimal from unittest.mock import patch from django.contrib.auth import authenticate, login from django.contrib.auth import views as auth_views from django.contrib.auth.forms import AuthenticationForm, UserCreationForm from django.contrib.auth.hashers import make_password from django.contrib.auth.models import User from django.core.exceptions import ValidationError from django.test import Client, TestCase from django.urls import resolve, reverse from test_plus import TestCase from .forms import CustomUserCreationForm from .models import * from .views import * Now that we have understood the theory, motivation and the approach, let’s start writing tests.\nTesting URLS This is a test class for testing the URLs of a web application. The test class inherits from Django’s TestCase class, and it has test methods for each of the URLs in the application.\nThe class has a setUp() method that creates a test user to use for the tests.\nThe test methods are named according to the following convention:\ntest[PageName] tests that the page with the given name can be accessed by the client. test[PageName]Url tests that the URL for the given page resolves to the correct view function. test[PageName]Template tests that the correct template is used for the given page. test[PageName]ContainsCorrectHtml tests that the correct HTML content is displayed on the given page. test[PageName]FormCorrect tests that the correct form is used for the given page. test[PageName]RedirectsTo[OtherPageName] tests that the given page redirects to the correct other page. test[PageName]RedirectIfAlreadyLoggedIn tests that the given page redirects to the correct page if the user is already logged in. The test methods use Django’s testing client to make requests to the application’s URLs and check the responses. They use Django’s reverse() function to generate URLs for the application’s views, and they use Django’s resolve() function to match URLs to view functions. They also use Django’s assertTemplateUsed() function to check that the correct template is used, and they use Django’s assertContains() and assertNotContains() functions to check for the presence or absence of specific HTML content in the response.\nclass UrlTest(TestCase): # CREATE THE TEST USER def setUp(self): self.user = User.objects.create_user( username='testuser', email='testuser@example.com', password='12345' ) \"\"\" ---------------- HOME PAGE TESTS ----------------- \"\"\" def testHomePage(self): response = self.client.get('/') self.assertEqual(response.status_code, 200) def testHomePageUrl(self): url = reverse('home') self.assertEqual(resolve(url).func, home_view) def testHomePageTemplate(self): response = self.client.get('/') self.assertTemplateUsed(response, 'home.html') def testHomePageContainsCorrectHtml(self): response = self.client.get('/') self.assertContains(response, 'Top 10 CryptoCurrency Rankings') self.assertNotContains(response, 'Hi there! I should not be on the page.') \"\"\" ---------------- LOGIN PAGE TESTS ----------------- \"\"\" def testLoginPage(self): response = self.client.get('/login/') self.assertEqual(response.status_code, 200) def testLoginPageUrl(self): url = reverse('login') self.assertEqual(resolve(url).func, login_view) def testLoginPageTemplate(self): response = self.client.get('/login/') self.assertTemplateUsed(response, 'login.html') def testLoginPageContainsCorrectHtml(self): response = self.client.get('/login/') self.assertContains(response, 'Login') self.assertNotContains(response, 'Hi there! I should not be on the page.') def testLoginPageRedirectsToPortfolioPage(self): self.client.login(username=self.user.username, password='12345') response = self.client.get('/login/') self.assertRedirects(response, '/portfolio/') def testLoginPageRedirectIfAlreadyLoggedIn(self): self.client.login(username=self.user.username, password='12345') response = self.client.get('/login/') self.assertRedirects(response, '/portfolio/') def testLoginPageFormCorrect(self): response = self.client.get('/login/') form = response.context.get('form') self.assertIsInstance(form, AuthenticationForm) self.assertContains(response, 'csrfmiddlewaretoken') \"\"\" ---------------- SIGNUP PAGE TESTS ----------------- \"\"\" def testSignupPage(self): response = self.client.get('/signup/') self.assertEqual(response.status_code, 200) def testSignupPageUrl(self): url = reverse('signup') self.assertEqual(resolve(url).func, signup_view) def testSignupPageTemplate(self): response = self.client.get('/signup/') self.assertTemplateUsed(response, 'signup.html') def testSignupPageContainsCorrectHtml(self): response = self.client.get('/signup/') self.assertContains(response, 'Signup') self.assertNotContains(response, 'Hi there! I should not be on the page.') def testSignupPageRedirectIfAlreadyLoggedIn(self): self.client.login(username=self.user.username, password='12345') response = self.client.get('/signup/') self.assertRedirects(response, '/portfolio/') def testSignupPageFormCorrect(self): response = self.client.get('/signup/') form = response.context.get('form') self.assertIsInstance(form, UserCreationForm) self.assertContains(response, 'csrfmiddlewaretoken') \"\"\" ---------------- PORTFOLIO PAGE TESTS ----------------- \"\"\" def testPortfolioPageNoLogin(self): # check if logged out user can access portfolio page response = self.client.get('/portfolio/') self.assertEqual(response.status_code, 302) def testPortfolioPageLogin(self): # check if logged in user can access portfolio page self.client.login(username=self.user.username, password='12345') response = self.client.get('/portfolio/') self.assertEqual(response.status_code, 200) def testPortfolioPageUrl(self): url = reverse('portfolio') self.assertEqual(resolve(url).func, portfolio_view) def testPortfolioPageTemplate(self): self.client.login(username=self.user.username, password='12345') response = self.client.get('/portfolio/') self.assertTemplateUsed(response, 'portfolio.html') def testPortfolioPageContainsCorrectHtml(self): self.client.login(username=self.user.username, password='12345') response = self.client.get('/portfolio/') self.assertContains(response, 'Wallet') self.assertNotContains(response, 'Hi there! I should not be on the page.') \"\"\" ---------------- RESET PAGE TESTS ----------------- \"\"\" def testResetPasswordPageUrl(self): url = reverse('password_reset') self.assertEqual(resolve(url).func.view_class, auth_views.PasswordResetView) def testResetPasswordPageTemplate(self): response = self.client.get('/password_reset/') self.assertTemplateUsed(response, 'reset/password_reset.html') def testResetPasswordPageContainsCorrectHtml(self): response = self.client.get('/password_reset/') self.assertContains(response, 'Reset Password') self.assertNotContains(response, 'Hi there! I should not be on the page.') def testResetPasswordDonePageUrl(self): url = reverse('password_reset_done') self.assertEqual(resolve(url).func.view_class, auth_views.PasswordResetDoneView) def testResetPasswordDonePageTemplate(self): response = self.client.get('/password_reset_done/') self.assertTemplateUsed(response, 'reset/password_reset_done.html') def testResetPasswordDonePageContainsCorrectHtml(self): response = self.client.get('/password_reset_done/') self.assertContains(response, 'An email has been sent with instructions to reset your password') self.assertNotContains(response, 'Hi there! I should not be on the page.') def testResetPasswordCompletePageUrl(self): url = reverse('password_reset_complete') self.assertEqual(resolve(url).func.view_class, auth_views.PasswordResetCompleteView) def testResetPasswordCompletePageTemplate(self): response = self.client.get('/password_reset_complete/') self.assertTemplateUsed(response, 'reset/password_reset_complete.html') def testResetPasswordCompletePageContainsCorrectHtml(self): response = self.client.get('/password_reset_complete/') self.assertContains(response, 'Your password has been set.') self.assertNotContains(response, 'Hi there! I should not be on the page.') \"\"\" ---------------- SEARCH PAGE TESTS ----------------- \"\"\" def testSearchPageNoLogin(self): response = self.client.get('/search/') self.assertEqual(response.status_code, 302) def testSearchPageUrl(self): url = reverse('search') self.assertEqual(resolve(url).func, search_view) # check if search page can only be accessed by POST request def testSearchPagePostOnly(self): self.client.login(username=self.user.username, password='12345') response = self.client.get('/search/') self.assertEqual(response.status_code, 405) response = self.client.post('/search/') self.assertEqual(response.status_code, 200) Testing Models These test cases are written using the Python unittest framework and are designed to test the functionality of different models in a Django web application.\nThe setUp() method is a special method that is run before every test method. In this method, two User objects are created - one to serve as a test user and the other as a referral user.\nThe individual test methods are defined using the def keyword, followed by the name of the test method. Each test method tests a specific aspect of a particular model, such as the User, Cryptocurrency, Referral, Portfolio, or Profile model.\nWithin each test method, specific actions are taken to test certain aspects of the model, such as creating an instance of the model, setting its attributes, and checking that the expected values are returned. For example, the testUserModelCorrectData() method checks that the attributes of the User model, such as username and email, are correctly set.\nThe assert statements are used to check that the expected values are equal to the actual values. If the test fails, an error is raised and the test method stops running.\nOverall, these test cases aim to ensure that each model in the Django web application functions correctly and behaves as expected.\nclass ModelTest(TestCase): # CREATE THE TEST USER def setUp(self): self.user = User.objects.create_user( username='testuser2', email='testuser2@example.com', password='12345' ) self.referral = User.objects.create_user( username='referraluser', email='referreduser@example.com', password='12345' ) \"\"\" ---------------- USER MODEL TESTS ----------------- \"\"\" def testUserModelCorrectData(self): test_user = self.user self.assertEqual(test_user.username, 'testuser2') self.assertEqual(test_user.email, 'testuser2@example.com') self.assertTrue(isinstance(test_user, User)) self.assertTrue(test_user.is_active) self.assertFalse(test_user.is_staff) def testErrorOnDuplicateUsername(self): with self.assertRaises(IntegrityError): User.objects.create_user( username='testuser2', email='testuser2@example.com', password='12345' ) def testErrorOnDuplicateEmail(self): with self.assertRaises(IntegrityError): User.objects.create_user( username='testuser3', email='testuser2@example.com', password='12345' ) \"\"\" ---------------- CRYPTOCURRENCY MODEL TESTS ----------------- \"\"\" def testCryptocurrencyModel(self): cryptocurrency = Cryptocurrency.objects.create( user = User.objects.create(username='testuser'), id_from_api = 'bitcoin', name = 'Bitcoin', symbol = 'BTC', current_price = 10000, quantity = 1 ) self.assertEqual(cryptocurrency.name, 'Bitcoin') self.assertEqual(cryptocurrency.symbol, 'BTC') self.assertEqual(cryptocurrency.current_price, 10000) self.assertEqual(cryptocurrency.quantity, 1) self.assertEqual(cryptocurrency.user.username, 'testuser') self.assertTrue(isinstance(cryptocurrency, Cryptocurrency)) def testCryptocurrencyModelErrorOnDuplicate(self): Cryptocurrency.objects.create( user = User.objects.create(username='testuser'), id_from_api = 'bitcoin', name = 'Bitcoin', symbol = 'BTC', current_price = 10000, quantity = 1 ) with self.assertRaises(IntegrityError): Cryptocurrency.objects.create( user = User.objects.create(username='testuser'), id_from_api = 'bitcoin', name = 'Bitcoin', symbol = 'BTC', current_price = 10000, quantity = 1 ) self.fail('Cryptocurrency model should not allow duplicate cryptocurrencies') def testCryptocurrencyCurrentPrice(self): crypto = Cryptocurrency.objects.create( user=self.user, id_from_api='bitcoin', name='Bitcoin', symbol='BTC', current_price=10000, quantity=1 ) self.assertEqual(crypto.current_price, 10000) def testCryptocurrencyStr(self): crypto = Cryptocurrency.objects.create( user=self.user, id_from_api='bitcoin', name='Bitcoin', symbol='BTC', current_price=10000, quantity=1 ) self.assertEqual(str(crypto), 'Bitcoin (BTC)') def testCryptocurrencyQuantityDefaultValue(self): crypto = Cryptocurrency.objects.create( user=self.user, id_from_api='bitcoin', name='Bitcoin', symbol='BTC', current_price=10000 ) self.assertEqual(crypto.quantity, 1) \"\"\" ---------------- REFERRAL MODEL TESTS ----------------- \"\"\" # make a referral and check if it is created correctly def testReferralModel(self): referral = Referal.objects.create( user=self.user, referrer=self.referral ) self.assertEqual(referral.user.username, 'testuser2') self.assertEqual(referral.referrer.username, 'referraluser') self.assertTrue(isinstance(referral, Referal)) \"\"\" ---------------- PORTFOLIO MODEL TESTS ----------------- \"\"\" def testPortfolioModel(self): portfolio = Portfolio.objects.create( user=self.user, total_value=10000 ) self.assertEqual(portfolio.user.username, 'testuser2') self.assertEqual(portfolio.total_value, 10000) self.assertTrue(isinstance(portfolio, Portfolio)) \"\"\" ---------------- PROFILE MODEL TESTS ----------------- \"\"\" def testProfileModel(self): # referral code should be generated automatically using small uuid import shortuuid shortuuid.ShortUUID().random(length=10) referral_code = shortuuid.uuid() # make a dummy user dummy_user = User.objects.create_user( username='dummyprofile', email = 'dummyemail@example.com', password='12345' ) profile = Profile.objects.create( user=dummy_user, referral_code=referral_code ) self.assertEqual(profile.user.username, 'dummyprofile') self.assertEqual(profile.referral_code, referral_code) self.assertTrue(isinstance(profile, Profile)) Testing Views \"\"\" MAKING SEPERATE TEST CLASSES FOR VIEWS \"\"\" class LoginViewTest(TestCase): def setUp(self): self.client = Client() self.user = User.objects.create_user(username='testuser', email=\"example@example.com\", password='testpass') def test_login_view_with_valid_credentials(self): url = reverse('login') response = self.client.post(url, {'username': 'testuser', 'password': 'testpass'}) self.assertRedirects(response, reverse('portfolio')) def test_login_view_with_invalid_credentials(self): url = reverse('login') response = self.client.post(url, {'username': 'invaliduser', 'password': 'invalidpass'}) self.assertEqual(response.status_code, 200) self.assertContains(response, \"Invalid username or password.\") class TestAddToPortfolioView(TestCase): def setUp(self): self.client = Client() self.user = User.objects.create_user( username='testuser', password='testpassword') self.client.login(username='testuser', password='testpassword') def test_add_to_portfolio_view_success(self): with patch('mainapp.views.requests.get') as mock_get: mock_data = { 'name': 'Bitcoin', 'id': 'bitcoin', 'symbol': 'BTC', 'market_data': { 'current_price': { 'usd': 50000.00 } } } mock_get.return_value.json.return_value = mock_data data = { 'id': 'bitcoin', 'quantity': 10 } response = self.client.post( reverse('add_to_portfolio'), data=data) self.assertEqual(response.status_code, 302) self.assertRedirects(response, reverse('portfolio')) crypto_currency = Cryptocurrency.objects.get( user=self.user, id_from_api='bitcoin') self.assertEqual(crypto_currency.name, 'Bitcoin') self.assertEqual(crypto_currency.symbol, 'BTC') self.assertEqual(crypto_currency.quantity, 10) self.assertEqual(crypto_currency.current_price, 50000.00) portfolio = Portfolio.objects.get(user=self.user) self.assertEqual(portfolio.total_value, 500000.00) def test_add_to_portfolio_view_get_request(self): response = self.client.get(reverse('add_to_portfolio')) self.assertEqual(response.status_code, 200) self.assertContains(response, 'Need a crypto currency to add to your portfolio. Go back to the home page and search for a crypto currency.') from django.contrib.auth.models import User from django.test import Client, TestCase class SearchViewTestCase(TestCase): def setUp(self): self.client = Client() self.user = User.objects.create_user( username='testuser', password='testpassword' ) self.client.login(username='testuser', password='testpassword') def test_valid_search(self): response = self.client.post('/search/', {'search_query': 'bitcoin'}) self.assertEqual(response.status_code, 200) self.assertContains(response, 'BTC') def test_invalid_search(self): response = self.client.post('/search/', {'search_query': 'invalid_crypto_currency'}) self.assertEqual(response.status_code, 200) self.assertContains(response, 'No crypto currency found based on your search query.') class DeleteFromPortfolioViewTest(TestCase): def setUp(self): self.client = Client() self.user = User.objects.create_user(username='testuser', password='testpass') self.crypto_currency = Cryptocurrency.objects.create(user=self.user, id_from_api='bitcoin', name='Bitcoin', symbol='BTC', current_price=Decimal('10000'), quantity=Decimal('2')) self.portfolio = Portfolio.objects.create(user=self.user, total_value=Decimal('20000')) def test_delete_from_portfolio_view(self): self.client.login(username='testuser', password='testpass') url = reverse('delete_from_portfolio', args=[self.crypto_currency.pk]) response = self.client.post(url) self.assertRedirects(response, reverse('portfolio')) self.assertFalse(Cryptocurrency.objects.filter(pk=self.crypto_currency.pk).exists()) self.portfolio.refresh_from_db() self.assertEqual(self.portfolio.total_value, Decimal('0')) def test_delete_from_portfolio_view_with_unauthenticated_user(self): url = reverse('delete_from_portfolio', args=[self.crypto_currency.pk]) response = self.client.post(url) self.assertRedirects(response, reverse('login') + '?next=' + url) self.assertTrue(Cryptocurrency.objects.filter(pk=self.crypto_currency.pk).exists()) self.portfolio.refresh_from_db() self.assertEqual(self.portfolio.total_value, Decimal('20000')) class TestHomeView(TestCase): def setUp(self): self.client = Client() self.top_10_crypto_url_global = 'https://api.coingecko.com/api/v3/coins/markets?vs_currency=USD\u0026order=market_cap_desc\u0026per_page=10\u0026page=1\u0026sparkline=true' self.top_10_crypto_data_global = requests.get(self.top_10_crypto_url_global).json() self.user = User.objects.create_user(username='testuser', password='testpass') self.crypto = Cryptocurrency.objects.create(name='Bitcoin', symbol='BTC', id_from_api='bitcoin', user=self.user, current_price=Decimal('10000'), quantity=Decimal('2')) self.portfolio = Portfolio.objects.create(user=self.user, total_value=Decimal('20000')) self.url = reverse('home') def test_home_view_authenticated(self): self.client.login(username='testuser', password='testpass') response = self.client.get(self.url) self.assertEqual(response.status_code, 200) self.assertTemplateUsed(response, 'home.html') self.assertTrue('top_10_crypto_data_global' in response.context) self.assertTrue('user_cryptocurrencies' in response.context) self.assertTrue('user_portfolio' in response.context) self.assertTrue('crypto_price_changes' in response.context) def test_home_view_unauthenticated(self): response = self.client.get(self.url) self.assertEqual(response.status_code, 200) self.assertTemplateUsed(response, 'home.html') self.assertTrue('top_10_crypto_data_global' in response.context) self.assertFalse('user_cryptocurrencies' in response.context) self.assertFalse('user_portfolio' in response.context) self.assertFalse('crypto_price_changes' in response.context) class SignupWithReferrerViewTestCase(TestCase): def setUp(self): self.client = Client() self.referrer = User.objects.create_user( username='test_referrer', email='test_referrer@example.com', password='testpassword') self.referrer_profile = Profile.objects.get(user=self.referrer) self.referral_code = self.referrer_profile.referral_code def test_signup_with_referrer_view_GET(self): response = self.client.get(reverse('signup_with_referrer_view', args=[self.referral_code])) self.assertEqual(response.status_code, 200) self.assertTemplateUsed(response, 'signup.html') def test_signup_with_referrer_view_POST(self): data = { 'username': 'testuser', 'email': 'testuser@example.com', 'password1': 'testpassword', 'password2': 'testpassword' } response = self.client.post(reverse('signup_with_referrer_view', args=[self.referral_code]), data) self.assertEqual(response.status_code, 302) self.assertEqual(User.objects.count(), 2) # get the user object from the database self.assertEqual(Referal.objects.get(user__username='testuser').referrer, self.referrer) self.assertEqual(Profile.objects.get(user__username='test_referrer').bonus, 100) self.assertRedirects(response, reverse('login')) class SignupViewTestCase(TestCase): def setUp(self): self.client = Client() self.signup_url = reverse('signup') self.valid_data = { 'username': 'johndoe', 'email': 'johndoe@example.com', 'password1': 'passw0rd', 'password2': 'passw0rd' } def test_signup_view_get(self): response = self.client.get(self.signup_url) self.assertEqual(response.status_code, 200) self.assertTemplateUsed(response, 'signup.html') self.assertIsInstance(response.context['form'], CustomUserCreationForm) def test_signup_view_post_invalid_data(self): invalid_data = self.valid_data.copy() invalid_data['password2'] = 'different_password' response = self.client.post(self.signup_url, invalid_data) self.assertEqual(response.status_code, 200) self.assertTemplateUsed(response, 'signup.html') self.assertIsInstance(response.context['form'], CustomUserCreationForm) self.assertEqual(User.objects.count(), 0) class LogoutViewTestCase(TestCase): def setUp(self): self.client = Client() self.user = User.objects.create_user( username='testuser', password='testpass' ) self.client.login(username='testuser', password='testpass') def test_logout_view(self): # make sure user is logged in response = self.client.get(reverse('home')) self.assertEqual(response.status_code, 200) # this is only visible to logged in users below the Top 10 Cryptocurrencies table self.assertTrue('24 Hour Price Changes' in str(response.content)) # logout response = self.client.get(reverse('logout')) self.assertEqual(response.status_code, 302) # check if user is logged out response = self.client.get(reverse('home')) self.assertEqual(response.status_code, 200) self.assertFalse('testuser' in str(response.content)) class LoginViewTestCase(TestCase): def setUp(self): self.client = Client() self.login_url = reverse('login') self.user = User.objects.create_user( username='testuser', email='testuser@test.com', password='testpass' ) def test_login_view_get(self): response = self.client.get(self.login_url) self.assertEqual(response.status_code, 200) self.assertTemplateUsed(response, 'login.html') def test_login_view_post_valid_credentials(self): response = self.client.post(self.login_url, { 'username': 'testuser', 'password': 'testpass', }) self.assertRedirects(response, reverse('portfolio')) user = authenticate(username='testuser', password='testpass') self.assertIsNotNone(user) self.assertEqual(user, self.user) self.assertTrue(user.is_authenticated) def test_login_view_post_invalid_credentials(self): response = self.client.post(self.login_url, { 'username': 'wronguser', 'password': 'wrongpass', }) self.assertEqual(response.status_code, 200) self.assertTemplateUsed(response, 'login.html') self.assertContains(response, \"Invalid username or password.\") def tearDown(self): self.user.delete() These are unit tests for a Django web application, testing various views in the application. Here’s a detailed explanation of each of the views being tested and the purpose of the tests:\nLoginViewTest: test_login_view_with_valid_credentials: This test checks if a user can successfully log in to the application with valid credentials. It sends a POST request to the login URL with a valid username and password, and expects to be redirected to the portfolio page (assuming successful login). test_login_view_with_invalid_credentials: This test checks if a user is unable to log in with invalid credentials. It sends a POST request to the login URL with an invalid username and password, and expects to receive a status code of 200 (assuming failed login) and to see an error message on the login page. TestAddToPortfolioView: test_add_to_portfolio_view_success: This test checks if a user can successfully add a cryptocurrency to their portfolio. It sends a POST request to the add-to-portfolio URL with a valid cryptocurrency ID and quantity, and expects to be redirected to the portfolio page (assuming successful addition). It also checks if the added cryptocurrency and its details (name, symbol, quantity, and current price) have been saved in the database, and if the user’s portfolio value has been updated accordingly. test_add_to_portfolio_view_get_request: This test checks if a user cannot add a cryptocurrency to their portfolio through a GET request. It sends a GET request to the add-to-portfolio URL and expects to receive a status code of 200 and an error message on the page. SearchViewTestCase: test_valid_search: This test checks if a user can successfully search for a cryptocurrency by sending a POST request to the search URL with a valid search query. It expects to receive a status code of 200 and to see the cryptocurrency’s symbol on the search results page. test_invalid_search: This test checks if a user receives an error message when searching for an invalid cryptocurrency. It sends a POST request to the search URL with an invalid search query and expects to receive a status code of 200 and an error message on the search results page. DeleteFromPortfolioViewTest This test case is testing a view called DeleteFromPortfolioView. The view is expected to receive a POST request with the primary key of a cryptocurrency object. The view should delete that cryptocurrency object from the database and update the user’s portfolio value accordingly. The setUp method creates a test client, a test user, a test cryptocurrency object, and a test portfolio object in the database. The test_delete_from_portfolio_view method tests the view when the user is authenticated. It logs in the user using the test client, makes a POST request to the view with the primary key of the test cryptocurrency object, and asserts that the response redirects to the portfolio page. It then checks that the test cryptocurrency object no longer exists in the database and that the portfolio’s total value is 0. The test_delete_from_portfolio_view_with_unauthenticated_user method tests the view when the user is not authenticated. It makes a POST request to the view with the primary key of the test cryptocurrency object and asserts that the response redirects to the login page. It then checks that the test cryptocurrency object still exists in the database and that the portfolio’s total value is still 20000. TestHomeView This test case is testing a view called HomeView. The view is expected to render a template called home.html and display a list of the top 10 cryptocurrencies, the user’s cryptocurrencies, the user’s portfolio, and the percentage changes in cryptocurrency prices. The setUp method creates a test client, a test user, a test cryptocurrency object, and a test portfolio object in the database. It also makes a request to an external API to get the top 10 cryptocurrencies. The test_home_view_authenticated method tests the view when the user is authenticated. It logs in the user using the test client, makes a GET request to the view, and asserts that the response status code is 200 and the correct template is used. It also checks that the response context contains the top 10 cryptocurrencies, the user’s cryptocurrencies, the user’s portfolio, and the percentage changes in cryptocurrency prices. The test_home_view_unauthenticated method tests the view when the user is not authenticated. It makes a GET request to the view and asserts that the response status code is 200 and the correct template is used. It also checks that the response context contains the top 10 cryptocurrencies but does not contain the user’s cryptocurrencies, the user’s portfolio, or the percentage changes in cryptocurrency prices. SignupWithReferrerViewTestCase This test case checks the behavior of the view used for signing up with a referral code. In the setUp() method, a test user (referrer) is created, and the referral code is obtained from their profile. The test_signup_with_referrer_view_GET() method sends a GET request to the view using the referral code and checks that the response status code is 200 and the 'signup.html’ template is used. The test_signup_with_referrer_view_POST() method sends a POST request with valid user data and the referral code. It checks that the response status code is 302, indicating a successful redirect, the User object count is 2, and the referrer of the test user is the referrer created in setUp(). Additionally, it checks that the bonus of the referrer is now 100, and the response redirects to the ‘login’ view. SignupViewTestCase This test case checks the behavior of the view used for normal user sign up. The setUp() method initializes the Client object, the URL of the view, and valid user data. The test_signup_view_get() method sends a GET request to the view and checks that the response status code is 200, the ‘signup.html’ template is used, and the context form is of type CustomUserCreationForm. The test_signup_view_post_invalid_data() method sends a POST request with invalid user data, and it checks that the response status code is 200, the ‘signup.html’ template is used, and the form is of type CustomUserCreationForm. Additionally, it checks that no User objects have been created. LogoutViewTestCase This test case checks the behavior of the view used for user logout. The setUp() method initializes the Client object, creates a test user, and logs them in. The test_logout_view() method sends a GET request to the home page and checks that the response status code is 200 and the ‘24 Hour Price Changes’ element is present. It then sends a GET request to the logout view and checks that the response status code is 302. Finally, it sends another GET request to the home page and checks that the response status code is 200, and the test user’s name is not present. LoginViewTestCase This test case checks the behavior of the view used for user login. The setUp() method initializes the Client object, the URL of the view, and creates a test user. The test_login_view_get() method sends a GET request to the view and checks that the response status code is 200, and the 'login.html' template is used. The test_login_view_post_valid_credentials() method sends a POST request with valid user credentials and checks that the response is a successful redirect to the portfolio view, the user object is authenticated, and the user object is the same as the one created in setUp(). The test_login_view_post_invalid_credentials() method sends a POST request with invalid user credentials and checks that the response status code is 200, the ‘login.html’ template is used, and an error message is displayed. Finally, the tearDown() method deletes the test user object. How to Run Tests All tests are written in the tests.py file in the mainapp folder.\n# to run all tests python manage.py test # to run tests for a specific class python manage.py test -k # start coverage coverage run --source='.' --omit=mainapp\\tests.py manage.py test mainapp # generate coverage report coverage html # check the htmlcov folder and open the index.html file Conclusion This concludes the third and the final part of the series. Here we learned how to write tests for our Django project as well as the TDD approach. We saw how to write tests for models, views, and reverse urls and wrote over 60 test cases for our project achieving 90%+ test coverage.\nThis project was a great learning experience for me. I learned a lot about Django, and I also learned how to use the CoinGecko API. I also learned how to use the unittest module to write tests for my Django project. I hope you enjoyed reading this article. If you have any questions or suggestions, feel free to leave a comment below. Thank you for reading! 😊\n",
  "wordCount" : "3968",
  "inLanguage": "en",
  "image":"https://atharvashah.netlify.app/blog/django-crypto-app/cover-3.webp","datePublished": "2023-05-01T23:20:34+05:30",
  "dateModified": "2023-05-01T23:20:34+05:30",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://atharvashah.netlify.app/posts/tech/django-crypto-app/part3/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Atharva Shah",
    "logo": {
      "@type": "ImageObject",
      "url": "https://atharvashah.netlify.app/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>


<header class="header">
    
    <div id="scroll-progress"></div> 
    
    <nav class="nav">
        <div class="logo">
            <a href="https://atharvashah.netlify.app/" accesskey="h" title="Atharva Shah (Alt + H)">
            <img src="https://atharvashah.netlify.app/profile/header_button.webp" alt="logo" aria-label="logo"
                 height="30">Atharva Shah</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://atharvashah.netlify.app/posts/tech/" title="💻Tech">
                <span>💻Tech</span>
                </a>
            </li>
            <li>
                <a href="https://atharvashah.netlify.app/posts/personal/" title="🍿Personal">
                <span>🍿Personal</span>
                </a>
            </li>
            <li>
                <a href="https://atharvashah.netlify.app/about/" title="👨🏻About">
                <span>👨🏻About</span>
                </a>
            </li>
            <li>
                <a href="https://atharvashah.netlify.app/tags/" title="🏷️Tags">
                <span>🏷️Tags</span>
                </a>
            </li>
            <li>
                <a href="https://atharvashah.netlify.app/archives/" title="📜Archive">
                <span>📜Archive</span>
                </a>
            </li>
            <li>
                <a href="https://atharvashah.netlify.app/search/" title="🔍Search (Alt &#43; /)" accesskey=/>
                <span>🔍Search</span>
                </a>
            </li>
        </ul>
    </nav>

</header>
    <main class="main">

<article class="post-single">
    <header class="post-header">
    <div class="breadcrumbs"><a href="https://atharvashah.netlify.app/">Home</a>&nbsp;»&nbsp;<a href="https://atharvashah.netlify.app/posts/">📚 All Posts</a>&nbsp;»&nbsp;<a href="https://atharvashah.netlify.app/posts/tech/">💻Tech</a></div>
    <h1 class="post-title">
      Django Crypto App Part 3
    </h1>
    <div class="post-description">
      Functional requirements of what we are building, the approach, the high-level design and the project setup using Django.
    </div>
    <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>May 1, 2023
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>3968 words
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>19 mins
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="https://atharvashah.netlify.app/tags/django/" style="color: var(--secondary)!important;">django</a>
                &nbsp;<a href="https://atharvashah.netlify.app/tags/python/" style="color: var(--secondary)!important;">python</a>
            </span>
        </span>
    </span>
</span>

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://atharvashah.netlify.app/blog/django-crypto-app/cover-3.webp" alt="Part 3 - Wrap-Up and Testing">
        <p>Here, we will wrap the series up by discussing testing approach by writing test cases for Models, Views and Templates using Pytest.</p>
</figure><aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#test-driven-development-explained" aria-label="Test Driven Development Explained">Test Driven Development Explained</a><ul>
                        
                <li>
                    <a href="#url-testing" aria-label="URL Testing">URL Testing</a></li>
                <li>
                    <a href="#model-testing" aria-label="Model Testing">Model Testing</a></li>
                <li>
                    <a href="#view-testing" aria-label="View Testing">View Testing</a></li></ul>
                </li>
                <li>
                    <a href="#writing-tests" aria-label="Writing Tests">Writing Tests</a><ul>
                        
                <li>
                    <a href="#testing-urls" aria-label="Testing URLS">Testing URLS</a></li>
                <li>
                    <a href="#testing-models" aria-label="Testing Models">Testing Models</a></li>
                <li>
                    <a href="#testing-views" aria-label="Testing Views">Testing Views</a></li></ul>
                </li>
                <li>
                    <a href="#how-to-run-tests" aria-label="How to Run Tests">How to Run Tests</a></li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        if (elements) {
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                    (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                    return element;
                }
            }) || activeElement

            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                if (element === activeElement){
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
                } else {
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
                }
            })
        }
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>Welcome to the final part of the 3-part technical tutorial series, where have been building a Django project that enables users to manage their cryptocurrency portfolios. To implement the functionalities and additional features, we&rsquo;ll be utilizing API calls to coingecko or any other cryptocurrency API.</p>
<style>
    .fancy-link {
         
        color: #ff6600;
        text-decoration: none !important;
        font-weight: bolder;
    }

    .fancy-link:hover {
        color: black;
        background-color: rgb(255, 255, 255);
        transition: all 0.3s ease;
        font-weight: bolder;
    }

    .fancy-text{
        font-style: italic;
        font-weight: bolder;
        margin-top:50px;
        margin-bottom: 50px !important;
        text-align: center;
        padding: 10px 0;
        border-top: 1px solid rgb(141, 141, 141);
        border-bottom: 1px solid rgb(141, 141, 141);
    }
</style>

<p class="fancy-text">Want to start from the beginning? <a class="fancy-link" href="/posts/tech/django-crypto-app/part1/">Read Part 1</a></p>

<p>In the first part, we set up the project and created the models. In the second part continued off from that point and added all the templates, views and urls and code up the entire crypto project. So, if you haven&rsquo;t read the previous parts, I highly recommend you to do so before continuing with this part. Here, we will exclusively discuss testing approach by writing test cases for Models, Views and Templates using Pytest. We will also write a ton of tests to ensure that our code is working as expected and generate a coverage report to see how much of our code is covered by the tests.</p>
<p>The code for the entirety of the project can be found here -&gt;  <strong><a href="https://github.com/HighnessAtharva/django-crypto-app">Github Repo for Django Crypto App</a></strong></p>
<p>Testing is an important part of software development. It helps us to ensure that our code is working as expected and also helps us to catch bugs early on. It also helps us to ensure that our code is maintainable and readable. So, let&rsquo;s get started.</p>
<p><a href="https://www.buymeacoffee.com/AtharvaShah">






<figure>
  
    <img
      sizes="100vw"
      src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png"
      alt="Buy Me A Coffee"
      loading="lazy"
      >
  
  
</figure></a></p>
<h2 id="test-driven-development-explained">Test Driven Development Explained<a hidden class="anchor" aria-hidden="true" href="#test-driven-development-explained">#</a></h2>
<p>In Django, automated testing can be performed at three levels: URL testing, model testing, and view testing.</p>
<h3 id="url-testing">URL Testing<a hidden class="anchor" aria-hidden="true" href="#url-testing">#</a></h3>
<p>URL testing in Django is used to check if the endpoints specified in the URL patterns are correctly configured and pointing to the appropriate views. This is important because if an endpoint is incorrect or pointing to the wrong view, the application will not be able to process the request, leading to errors or incorrect behavior. URL testing is typically performed using the Django Client class, which simulates a web client and allows the developer to send requests to the application.</p>
<h3 id="model-testing">Model Testing<a hidden class="anchor" aria-hidden="true" href="#model-testing">#</a></h3>
<p>Model testing in Django is used to check if the data stored in the database matches the expected schema and constraints specified in the models.py file. It helps ensure that the application is storing and retrieving data correctly and that the database is working as expected. Model testing is typically performed using the Django TestCase class and its various assertion methods, which allow the developer to create test data, save it to the database, and verify that the data has been saved correctly.</p>
<style>
    .fancy-link {
         
        color: #ff6600;
        text-decoration: none !important;
        font-weight: bolder;
    }

    .fancy-link:hover {
        color: black;
        background-color: rgb(255, 255, 255);
        transition: all 0.3s ease;
        font-weight: bolder;
    }

    .fancy-text{
        font-style: italic;
        font-weight: bolder;
        margin-top:50px;
        margin-bottom: 50px !important;
        text-align: center;
        padding: 10px 0;
        border-top: 1px solid rgb(141, 141, 141);
        border-bottom: 1px solid rgb(141, 141, 141);
    }
</style>

<p class="fancy-text">Master Database Queries in Django with <a class="fancy-link" href="/posts/tech/django-orm-exercises/">40 Django ORM Exercises</a></p>

<h3 id="view-testing">View Testing<a hidden class="anchor" aria-hidden="true" href="#view-testing">#</a></h3>
<p>View testing in Django is used to check if the business logic defined in the views.py file is functioning correctly. It is used to test whether the views are handling requests as expected and returning the appropriate responses. View testing is typically performed using the Django TestCase class and its various assertion methods, which allow the developer to simulate requests and verify the responses.</p>
<blockquote>
<mark>For this crypto-wallet app, I used all three types of automated testing.</mark>
</blockquote>
<p><strong>For URL testing</strong>, I created a series of test cases that used the Django Client class to simulate requests to various endpoints in the application. Each test case sent a request to the endpoint and verified that the response was the expected template.</p>
<p><strong>For model testing</strong>, I created a series of test cases that used the Django TestCase class to create test data, save it to the database, and verify that it had been saved correctly. Each test case tested a specific model or relationship between models to ensure that the data was being stored and retrieved correctly.</p>
<p><strong>For view testing</strong>, I created a series of test cases that used the Django TestCase class to simulate requests to various views in the application. Each test case sent a request to the view and verified that the response was the expected result.</p>
<h2 id="writing-tests">Writing Tests<a hidden class="anchor" aria-hidden="true" href="#writing-tests">#</a></h2>
<p>Go to the <code>tests.py</code> file in the <code>mainapp</code> folder and add the following imports since we will be using them in our tests.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> decimal <span style="color:#f92672">import</span> Decimal
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> unittest.mock <span style="color:#f92672">import</span> patch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.contrib.auth <span style="color:#f92672">import</span> authenticate, login
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.contrib.auth <span style="color:#f92672">import</span> views <span style="color:#66d9ef">as</span> auth_views
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.contrib.auth.forms <span style="color:#f92672">import</span> AuthenticationForm, UserCreationForm
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.contrib.auth.hashers <span style="color:#f92672">import</span> make_password
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.contrib.auth.models <span style="color:#f92672">import</span> User
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.core.exceptions <span style="color:#f92672">import</span> ValidationError
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.test <span style="color:#f92672">import</span> Client, TestCase
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.urls <span style="color:#f92672">import</span> resolve, reverse
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> test_plus <span style="color:#f92672">import</span> TestCase
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> .forms <span style="color:#f92672">import</span> CustomUserCreationForm
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> .models <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> .views <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span></code></pre></div><p>Now that we have understood the theory, motivation and the approach, let&rsquo;s start writing tests.</p>
<h3 id="testing-urls">Testing URLS<a hidden class="anchor" aria-hidden="true" href="#testing-urls">#</a></h3>
<p>This is a test class for testing the URLs of a web application. The test class inherits from Django&rsquo;s <code>TestCase</code> class, and it has test methods for each of the URLs in the application.</p>
<p>The class has a <code>setUp()</code> method that creates a test user to use for the tests.</p>
<p>The test methods are named according to the following convention:</p>
<ul>
<li><code>test[PageName]</code> tests that the page with the given name can be accessed by the client.</li>
<li><code>test[PageName]Url</code> tests that the URL for the given page resolves to the correct view function.</li>
<li><code>test[PageName]Template</code> tests that the correct template is used for the given page.</li>
<li><code>test[PageName]ContainsCorrectHtml</code> tests that the correct HTML content is displayed on the given page.</li>
<li><code>test[PageName]FormCorrect</code> tests that the correct form is used for the given page.</li>
<li><code>test[PageName]RedirectsTo[OtherPageName]</code> tests that the given page redirects to the correct other page.</li>
<li><code>test[PageName]RedirectIfAlreadyLoggedIn</code> tests that the given page redirects to the correct page if the user is already logged in.</li>
</ul>
<p>The test methods use Django&rsquo;s testing client to make requests to the application&rsquo;s URLs and check the responses. They use Django&rsquo;s <code>reverse()</code> function to generate URLs for the application&rsquo;s views, and they use Django&rsquo;s <code>resolve()</code> function to match URLs to view functions. They also use Django&rsquo;s <code>assertTemplateUsed()</code> function to check that the correct template is used, and they use Django&rsquo;s <code>assertContains()</code> and <code>assertNotContains()</code> functions to check for the presence or absence of specific HTML content in the response.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UrlTest</span>(TestCase):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># CREATE THE TEST USER</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>,
</span></span><span style="display:flex;"><span>            email<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>            password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    HOME PAGE TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testHomePage</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testHomePageUrl</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;home&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(resolve(url)<span style="color:#f92672">.</span>func, home_view)  
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testHomePageTemplate</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;home.html&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testHomePageContainsCorrectHtml</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;Top 10 CryptoCurrency Rankings&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertNotContains(response, <span style="color:#e6db74">&#39;Hi there! I should not be on the page.&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    LOGIN PAGE TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testLoginPage</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/login/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testLoginPageUrl</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;login&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(resolve(url)<span style="color:#f92672">.</span>func, login_view)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testLoginPageTemplate</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/login/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;login.html&#39;</span>)
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testLoginPageContainsCorrectHtml</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/login/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;Login&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertNotContains(response, <span style="color:#e6db74">&#39;Hi there! I should not be on the page.&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testLoginPageRedirectsToPortfolioPage</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/login/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertRedirects(response, <span style="color:#e6db74">&#39;/portfolio/&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testLoginPageRedirectIfAlreadyLoggedIn</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/login/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertRedirects(response, <span style="color:#e6db74">&#39;/portfolio/&#39;</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testLoginPageFormCorrect</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/login/&#39;</span>)
</span></span><span style="display:flex;"><span>        form <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>context<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;form&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertIsInstance(form, AuthenticationForm)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;csrfmiddlewaretoken&#39;</span>)
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SIGNUP PAGE TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testSignupPage</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/signup/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testSignupPageUrl</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;signup&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(resolve(url)<span style="color:#f92672">.</span>func, signup_view)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testSignupPageTemplate</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/signup/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;signup.html&#39;</span>)
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testSignupPageContainsCorrectHtml</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/signup/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;Signup&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertNotContains(response, <span style="color:#e6db74">&#39;Hi there! I should not be on the page.&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testSignupPageRedirectIfAlreadyLoggedIn</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/signup/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertRedirects(response, <span style="color:#e6db74">&#39;/portfolio/&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testSignupPageFormCorrect</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/signup/&#39;</span>)
</span></span><span style="display:flex;"><span>        form <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>context<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;form&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertIsInstance(form, UserCreationForm)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;csrfmiddlewaretoken&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    PORTFOLIO PAGE TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testPortfolioPageNoLogin</span>(self):    
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># check if logged out user can access portfolio page</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/portfolio/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">302</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testPortfolioPageLogin</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># check if logged in user can access portfolio page</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/portfolio/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testPortfolioPageUrl</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;portfolio&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(resolve(url)<span style="color:#f92672">.</span>func, portfolio_view)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testPortfolioPageTemplate</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/portfolio/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;portfolio.html&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testPortfolioPageContainsCorrectHtml</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/portfolio/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;Wallet&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertNotContains(response, <span style="color:#e6db74">&#39;Hi there! I should not be on the page.&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    RESET PAGE TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testResetPasswordPageUrl</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;password_reset&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(resolve(url)<span style="color:#f92672">.</span>func<span style="color:#f92672">.</span>view_class, auth_views<span style="color:#f92672">.</span>PasswordResetView)
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testResetPasswordPageTemplate</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/password_reset/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;reset/password_reset.html&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testResetPasswordPageContainsCorrectHtml</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/password_reset/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;Reset Password&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertNotContains(response, <span style="color:#e6db74">&#39;Hi there! I should not be on the page.&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testResetPasswordDonePageUrl</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;password_reset_done&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(resolve(url)<span style="color:#f92672">.</span>func<span style="color:#f92672">.</span>view_class, auth_views<span style="color:#f92672">.</span>PasswordResetDoneView)
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testResetPasswordDonePageTemplate</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/password_reset_done/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;reset/password_reset_done.html&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testResetPasswordDonePageContainsCorrectHtml</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/password_reset_done/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;An email has been sent with instructions to reset your password&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertNotContains(response, <span style="color:#e6db74">&#39;Hi there! I should not be on the page.&#39;</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testResetPasswordCompletePageUrl</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;password_reset_complete&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(resolve(url)<span style="color:#f92672">.</span>func<span style="color:#f92672">.</span>view_class, auth_views<span style="color:#f92672">.</span>PasswordResetCompleteView)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testResetPasswordCompletePageTemplate</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/password_reset_complete/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;reset/password_reset_complete.html&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testResetPasswordCompletePageContainsCorrectHtml</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/password_reset_complete/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;Your password has been set.&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertNotContains(response, <span style="color:#e6db74">&#39;Hi there! I should not be on the page.&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    SEARCH PAGE TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>         
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testSearchPageNoLogin</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/search/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">302</span>)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testSearchPageUrl</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;search&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(resolve(url)<span style="color:#f92672">.</span>func, search_view)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># check if search page can only be accessed by POST request</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testSearchPagePostOnly</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;/search/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">405</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#39;/search/&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span></code></pre></div><h3 id="testing-models">Testing Models<a hidden class="anchor" aria-hidden="true" href="#testing-models">#</a></h3>
<p>These test cases are written using the Python unittest framework and are designed to test the functionality of different models in a Django web application.</p>
<p>The setUp() method is a special method that is run before every test method. In this method, two User objects are created - one to serve as a test user and the other as a referral user.</p>
<p>The individual test methods are defined using the def keyword, followed by the name of the test method. Each test method tests a specific aspect of a particular model, such as the User, Cryptocurrency, Referral, Portfolio, or Profile model.</p>
<p>Within each test method, specific actions are taken to test certain aspects of the model, such as creating an instance of the model, setting its attributes, and checking that the expected values are returned. For example, the testUserModelCorrectData() method checks that the attributes of the User model, such as username and email, are correctly set.</p>
<p>The assert statements are used to check that the expected values are equal to the actual values. If the test fails, an error is raised and the test method stops running.</p>
<p>Overall, these test cases aim to ensure that each model in the Django web application functions correctly and behaves as expected.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ModelTest</span>(TestCase):
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># CREATE THE TEST USER</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser2&#39;</span>,
</span></span><span style="display:flex;"><span>            email<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser2@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>            password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>referral <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;referraluser&#39;</span>,
</span></span><span style="display:flex;"><span>            email<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;referreduser@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>            password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>       
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    USER MODEL TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testUserModelCorrectData</span>(self):
</span></span><span style="display:flex;"><span>        test_user <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>user
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(test_user<span style="color:#f92672">.</span>username, <span style="color:#e6db74">&#39;testuser2&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(test_user<span style="color:#f92672">.</span>email, <span style="color:#e6db74">&#39;testuser2@example.com&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(isinstance(test_user, User))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(test_user<span style="color:#f92672">.</span>is_active)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertFalse(test_user<span style="color:#f92672">.</span>is_staff)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testErrorOnDuplicateUsername</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> self<span style="color:#f92672">.</span>assertRaises(IntegrityError):
</span></span><span style="display:flex;"><span>            User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>                username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser2&#39;</span>,
</span></span><span style="display:flex;"><span>                email<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser2@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>                password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testErrorOnDuplicateEmail</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> self<span style="color:#f92672">.</span>assertRaises(IntegrityError):
</span></span><span style="display:flex;"><span>            User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>                username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser3&#39;</span>,
</span></span><span style="display:flex;"><span>                email<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser2@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>                password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    CRYPTOCURRENCY MODEL TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testCryptocurrencyModel</span>(self):
</span></span><span style="display:flex;"><span>        cryptocurrency <span style="color:#f92672">=</span> Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>            user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>),
</span></span><span style="display:flex;"><span>            id_from_api <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bitcoin&#39;</span>,
</span></span><span style="display:flex;"><span>            name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Bitcoin&#39;</span>, 
</span></span><span style="display:flex;"><span>            symbol <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;BTC&#39;</span>,
</span></span><span style="display:flex;"><span>            current_price <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>,
</span></span><span style="display:flex;"><span>            quantity <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(cryptocurrency<span style="color:#f92672">.</span>name, <span style="color:#e6db74">&#39;Bitcoin&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(cryptocurrency<span style="color:#f92672">.</span>symbol, <span style="color:#e6db74">&#39;BTC&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(cryptocurrency<span style="color:#f92672">.</span>current_price, <span style="color:#ae81ff">10000</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(cryptocurrency<span style="color:#f92672">.</span>quantity, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(cryptocurrency<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, <span style="color:#e6db74">&#39;testuser&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(isinstance(cryptocurrency, Cryptocurrency))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testCryptocurrencyModelErrorOnDuplicate</span>(self):
</span></span><span style="display:flex;"><span>        Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>            user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>),
</span></span><span style="display:flex;"><span>            id_from_api <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bitcoin&#39;</span>,
</span></span><span style="display:flex;"><span>            name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Bitcoin&#39;</span>, 
</span></span><span style="display:flex;"><span>            symbol <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;BTC&#39;</span>,
</span></span><span style="display:flex;"><span>            current_price <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>,
</span></span><span style="display:flex;"><span>            quantity <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> self<span style="color:#f92672">.</span>assertRaises(IntegrityError):
</span></span><span style="display:flex;"><span>            Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>                user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>),
</span></span><span style="display:flex;"><span>                id_from_api <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;bitcoin&#39;</span>,
</span></span><span style="display:flex;"><span>                name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Bitcoin&#39;</span>, 
</span></span><span style="display:flex;"><span>                symbol <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;BTC&#39;</span>,
</span></span><span style="display:flex;"><span>                current_price <span style="color:#f92672">=</span> <span style="color:#ae81ff">10000</span>,
</span></span><span style="display:flex;"><span>                quantity <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            )
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>fail(<span style="color:#e6db74">&#39;Cryptocurrency model should not allow duplicate cryptocurrencies&#39;</span>)
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testCryptocurrencyCurrentPrice</span>(self):
</span></span><span style="display:flex;"><span>        crypto <span style="color:#f92672">=</span> Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>            user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user,
</span></span><span style="display:flex;"><span>            id_from_api<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bitcoin&#39;</span>,
</span></span><span style="display:flex;"><span>            name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Bitcoin&#39;</span>, 
</span></span><span style="display:flex;"><span>            symbol<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;BTC&#39;</span>,
</span></span><span style="display:flex;"><span>            current_price<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>,
</span></span><span style="display:flex;"><span>            quantity<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(crypto<span style="color:#f92672">.</span>current_price, <span style="color:#ae81ff">10000</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testCryptocurrencyStr</span>(self):
</span></span><span style="display:flex;"><span>        crypto <span style="color:#f92672">=</span> Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>            user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user,
</span></span><span style="display:flex;"><span>            id_from_api<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bitcoin&#39;</span>,
</span></span><span style="display:flex;"><span>            name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Bitcoin&#39;</span>, 
</span></span><span style="display:flex;"><span>            symbol<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;BTC&#39;</span>,
</span></span><span style="display:flex;"><span>            current_price<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>,
</span></span><span style="display:flex;"><span>            quantity<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(str(crypto), <span style="color:#e6db74">&#39;Bitcoin (BTC)&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testCryptocurrencyQuantityDefaultValue</span>(self):
</span></span><span style="display:flex;"><span>        crypto <span style="color:#f92672">=</span> Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>            user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user,
</span></span><span style="display:flex;"><span>            id_from_api<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bitcoin&#39;</span>,
</span></span><span style="display:flex;"><span>            name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Bitcoin&#39;</span>, 
</span></span><span style="display:flex;"><span>            symbol<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;BTC&#39;</span>,
</span></span><span style="display:flex;"><span>            current_price<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(crypto<span style="color:#f92672">.</span>quantity, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    REFERRAL MODEL TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># make a referral and check if it is created correctly</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testReferralModel</span>(self):
</span></span><span style="display:flex;"><span>        referral <span style="color:#f92672">=</span> Referal<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>            user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user,
</span></span><span style="display:flex;"><span>            referrer<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>referral
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(referral<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, <span style="color:#e6db74">&#39;testuser2&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(referral<span style="color:#f92672">.</span>referrer<span style="color:#f92672">.</span>username, <span style="color:#e6db74">&#39;referraluser&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(isinstance(referral, Referal))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    PORTFOLIO MODEL TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testPortfolioModel</span>(self):
</span></span><span style="display:flex;"><span>        portfolio <span style="color:#f92672">=</span> Portfolio<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>            user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user,
</span></span><span style="display:flex;"><span>            total_value<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(portfolio<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, <span style="color:#e6db74">&#39;testuser2&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(portfolio<span style="color:#f92672">.</span>total_value, <span style="color:#ae81ff">10000</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(isinstance(portfolio, Portfolio))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    PROFILE MODEL TESTS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    -----------------
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">testProfileModel</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># referral code should be generated automatically using small uuid</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">import</span> shortuuid
</span></span><span style="display:flex;"><span>        shortuuid<span style="color:#f92672">.</span>ShortUUID()<span style="color:#f92672">.</span>random(length<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>          
</span></span><span style="display:flex;"><span>        referral_code <span style="color:#f92672">=</span> shortuuid<span style="color:#f92672">.</span>uuid()
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># make a dummy user</span>
</span></span><span style="display:flex;"><span>        dummy_user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;dummyprofile&#39;</span>,
</span></span><span style="display:flex;"><span>            email <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;dummyemail@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>            password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;12345&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        profile <span style="color:#f92672">=</span> Profile<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(
</span></span><span style="display:flex;"><span>            user<span style="color:#f92672">=</span>dummy_user,
</span></span><span style="display:flex;"><span>            referral_code<span style="color:#f92672">=</span>referral_code
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(profile<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>username, <span style="color:#e6db74">&#39;dummyprofile&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(profile<span style="color:#f92672">.</span>referral_code, referral_code)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(isinstance(profile, Profile))
</span></span></code></pre></div><h3 id="testing-views">Testing Views<a hidden class="anchor" aria-hidden="true" href="#testing-views">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34; 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">MAKING SEPERATE TEST CLASSES FOR VIEWS
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LoginViewTest</span>(TestCase):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> Client()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, email<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;example@example.com&#34;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpass&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_login_view_with_valid_credentials</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;login&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(url, {<span style="color:#e6db74">&#39;username&#39;</span>: <span style="color:#e6db74">&#39;testuser&#39;</span>, <span style="color:#e6db74">&#39;password&#39;</span>: <span style="color:#e6db74">&#39;testpass&#39;</span>})
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertRedirects(response, reverse(<span style="color:#e6db74">&#39;portfolio&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_login_view_with_invalid_credentials</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;login&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(url, {<span style="color:#e6db74">&#39;username&#39;</span>: <span style="color:#e6db74">&#39;invaliduser&#39;</span>, <span style="color:#e6db74">&#39;password&#39;</span>: <span style="color:#e6db74">&#39;invalidpass&#39;</span>})
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#34;Invalid username or password.&#34;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestAddToPortfolioView</span>(TestCase):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> Client()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpassword&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpassword&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_add_to_portfolio_view_success</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">with</span> patch(<span style="color:#e6db74">&#39;mainapp.views.requests.get&#39;</span>) <span style="color:#66d9ef">as</span> mock_get:
</span></span><span style="display:flex;"><span>            mock_data <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;name&#39;</span>: <span style="color:#e6db74">&#39;Bitcoin&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;id&#39;</span>: <span style="color:#e6db74">&#39;bitcoin&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;symbol&#39;</span>: <span style="color:#e6db74">&#39;BTC&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;market_data&#39;</span>: {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#39;current_price&#39;</span>: {
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#39;usd&#39;</span>: <span style="color:#ae81ff">50000.00</span>
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            mock_get<span style="color:#f92672">.</span>return_value<span style="color:#f92672">.</span>json<span style="color:#f92672">.</span>return_value <span style="color:#f92672">=</span> mock_data
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            data <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;id&#39;</span>: <span style="color:#e6db74">&#39;bitcoin&#39;</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#39;quantity&#39;</span>: <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(
</span></span><span style="display:flex;"><span>                reverse(<span style="color:#e6db74">&#39;add_to_portfolio&#39;</span>), data<span style="color:#f92672">=</span>data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">302</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertRedirects(response, reverse(<span style="color:#e6db74">&#39;portfolio&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        crypto_currency <span style="color:#f92672">=</span> Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>get(
</span></span><span style="display:flex;"><span>            user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user, id_from_api<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bitcoin&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(crypto_currency<span style="color:#f92672">.</span>name, <span style="color:#e6db74">&#39;Bitcoin&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(crypto_currency<span style="color:#f92672">.</span>symbol, <span style="color:#e6db74">&#39;BTC&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(crypto_currency<span style="color:#f92672">.</span>quantity, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(crypto_currency<span style="color:#f92672">.</span>current_price, <span style="color:#ae81ff">50000.00</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        portfolio <span style="color:#f92672">=</span> Portfolio<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>get(user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(portfolio<span style="color:#f92672">.</span>total_value, <span style="color:#ae81ff">500000.00</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_add_to_portfolio_view_get_request</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(reverse(<span style="color:#e6db74">&#39;add_to_portfolio&#39;</span>))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;Need a crypto currency to add to your portfolio. Go back to the home page and search for a crypto currency.&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.contrib.auth.models <span style="color:#f92672">import</span> User
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> django.test <span style="color:#f92672">import</span> Client, TestCase
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SearchViewTestCase</span>(TestCase):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> Client()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpassword&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpassword&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_valid_search</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#39;/search/&#39;</span>, {<span style="color:#e6db74">&#39;search_query&#39;</span>: <span style="color:#e6db74">&#39;bitcoin&#39;</span>})
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;BTC&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_invalid_search</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(<span style="color:#e6db74">&#39;/search/&#39;</span>, {<span style="color:#e6db74">&#39;search_query&#39;</span>: <span style="color:#e6db74">&#39;invalid_crypto_currency&#39;</span>})
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#39;No crypto currency found based on your search query.&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DeleteFromPortfolioViewTest</span>(TestCase):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> Client()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpass&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>crypto_currency <span style="color:#f92672">=</span> Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user, id_from_api<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bitcoin&#39;</span>, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Bitcoin&#39;</span>, symbol<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;BTC&#39;</span>, current_price<span style="color:#f92672">=</span>Decimal(<span style="color:#e6db74">&#39;10000&#39;</span>), quantity<span style="color:#f92672">=</span>Decimal(<span style="color:#e6db74">&#39;2&#39;</span>))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>portfolio <span style="color:#f92672">=</span> Portfolio<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user, total_value<span style="color:#f92672">=</span>Decimal(<span style="color:#e6db74">&#39;20000&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_delete_from_portfolio_view</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpass&#39;</span>)
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;delete_from_portfolio&#39;</span>, args<span style="color:#f92672">=</span>[self<span style="color:#f92672">.</span>crypto_currency<span style="color:#f92672">.</span>pk])
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(url)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertRedirects(response, reverse(<span style="color:#e6db74">&#39;portfolio&#39;</span>))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertFalse(Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>filter(pk<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>crypto_currency<span style="color:#f92672">.</span>pk)<span style="color:#f92672">.</span>exists())
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>portfolio<span style="color:#f92672">.</span>refresh_from_db()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(self<span style="color:#f92672">.</span>portfolio<span style="color:#f92672">.</span>total_value, Decimal(<span style="color:#e6db74">&#39;0&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_delete_from_portfolio_view_with_unauthenticated_user</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;delete_from_portfolio&#39;</span>, args<span style="color:#f92672">=</span>[self<span style="color:#f92672">.</span>crypto_currency<span style="color:#f92672">.</span>pk])
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(url)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertRedirects(response, reverse(<span style="color:#e6db74">&#39;login&#39;</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;?next=&#39;</span> <span style="color:#f92672">+</span> url)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>filter(pk<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>crypto_currency<span style="color:#f92672">.</span>pk)<span style="color:#f92672">.</span>exists())
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>portfolio<span style="color:#f92672">.</span>refresh_from_db()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(self<span style="color:#f92672">.</span>portfolio<span style="color:#f92672">.</span>total_value, Decimal(<span style="color:#e6db74">&#39;20000&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestHomeView</span>(TestCase):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> Client()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>top_10_crypto_url_global <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://api.coingecko.com/api/v3/coins/markets?vs_currency=USD&amp;order=market_cap_desc&amp;per_page=10&amp;page=1&amp;sparkline=true&#39;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>top_10_crypto_data_global <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(self<span style="color:#f92672">.</span>top_10_crypto_url_global)<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpass&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>crypto <span style="color:#f92672">=</span> Cryptocurrency<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Bitcoin&#39;</span>, symbol<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;BTC&#39;</span>, id_from_api<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;bitcoin&#39;</span>, user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user, current_price<span style="color:#f92672">=</span>Decimal(<span style="color:#e6db74">&#39;10000&#39;</span>), quantity<span style="color:#f92672">=</span>Decimal(<span style="color:#e6db74">&#39;2&#39;</span>))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>portfolio <span style="color:#f92672">=</span> Portfolio<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create(user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>user, total_value<span style="color:#f92672">=</span>Decimal(<span style="color:#e6db74">&#39;20000&#39;</span>))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;home&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_home_view_authenticated</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpass&#39;</span>)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(self<span style="color:#f92672">.</span>url)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;home.html&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(<span style="color:#e6db74">&#39;top_10_crypto_data_global&#39;</span> <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>context)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(<span style="color:#e6db74">&#39;user_cryptocurrencies&#39;</span> <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>context)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(<span style="color:#e6db74">&#39;user_portfolio&#39;</span> <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>context)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(<span style="color:#e6db74">&#39;crypto_price_changes&#39;</span> <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>context)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_home_view_unauthenticated</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(self<span style="color:#f92672">.</span>url)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;home.html&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(<span style="color:#e6db74">&#39;top_10_crypto_data_global&#39;</span> <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>context)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertFalse(<span style="color:#e6db74">&#39;user_cryptocurrencies&#39;</span> <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>context)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertFalse(<span style="color:#e6db74">&#39;user_portfolio&#39;</span> <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>context)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertFalse(<span style="color:#e6db74">&#39;crypto_price_changes&#39;</span> <span style="color:#f92672">in</span> response<span style="color:#f92672">.</span>context)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SignupWithReferrerViewTestCase</span>(TestCase):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> Client()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>referrer <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;test_referrer&#39;</span>, email<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;test_referrer@example.com&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpassword&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>referrer_profile <span style="color:#f92672">=</span> Profile<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>get(user<span style="color:#f92672">=</span>self<span style="color:#f92672">.</span>referrer)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>referral_code <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>referrer_profile<span style="color:#f92672">.</span>referral_code
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_signup_with_referrer_view_GET</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(reverse(<span style="color:#e6db74">&#39;signup_with_referrer_view&#39;</span>, args<span style="color:#f92672">=</span>[self<span style="color:#f92672">.</span>referral_code]))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;signup.html&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_signup_with_referrer_view_POST</span>(self):
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;username&#39;</span>: <span style="color:#e6db74">&#39;testuser&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;email&#39;</span>: <span style="color:#e6db74">&#39;testuser@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;password1&#39;</span>: <span style="color:#e6db74">&#39;testpassword&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;password2&#39;</span>: <span style="color:#e6db74">&#39;testpassword&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(reverse(<span style="color:#e6db74">&#39;signup_with_referrer_view&#39;</span>, args<span style="color:#f92672">=</span>[self<span style="color:#f92672">.</span>referral_code]), data)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">302</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>count(), <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># get the user object from the database</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(Referal<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>get(user__username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>)<span style="color:#f92672">.</span>referrer, self<span style="color:#f92672">.</span>referrer)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(Profile<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>get(user__username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;test_referrer&#39;</span>)<span style="color:#f92672">.</span>bonus, <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertRedirects(response, reverse(<span style="color:#e6db74">&#39;login&#39;</span>))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SignupViewTestCase</span>(TestCase):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> Client()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>signup_url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;signup&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>valid_data <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;username&#39;</span>: <span style="color:#e6db74">&#39;johndoe&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;email&#39;</span>: <span style="color:#e6db74">&#39;johndoe@example.com&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;password1&#39;</span>: <span style="color:#e6db74">&#39;passw0rd&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;password2&#39;</span>: <span style="color:#e6db74">&#39;passw0rd&#39;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_signup_view_get</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(self<span style="color:#f92672">.</span>signup_url)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;signup.html&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertIsInstance(response<span style="color:#f92672">.</span>context[<span style="color:#e6db74">&#39;form&#39;</span>], CustomUserCreationForm)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_signup_view_post_invalid_data</span>(self):
</span></span><span style="display:flex;"><span>        invalid_data <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>valid_data<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>        invalid_data[<span style="color:#e6db74">&#39;password2&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;different_password&#39;</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(self<span style="color:#f92672">.</span>signup_url, invalid_data)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;signup.html&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertIsInstance(response<span style="color:#f92672">.</span>context[<span style="color:#e6db74">&#39;form&#39;</span>], CustomUserCreationForm)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>count(), <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LogoutViewTestCase</span>(TestCase):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> Client()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpass&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>login(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpass&#39;</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_logout_view</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># make sure user is logged in</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(reverse(<span style="color:#e6db74">&#39;home&#39;</span>))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># this is only visible to logged in users below the Top 10 Cryptocurrencies table</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(<span style="color:#e6db74">&#39;24 Hour Price Changes&#39;</span> <span style="color:#f92672">in</span> str(response<span style="color:#f92672">.</span>content))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># logout</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(reverse(<span style="color:#e6db74">&#39;logout&#39;</span>))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">302</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># check if user is logged out</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(reverse(<span style="color:#e6db74">&#39;home&#39;</span>))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertFalse(<span style="color:#e6db74">&#39;testuser&#39;</span> <span style="color:#f92672">in</span> str(response<span style="color:#f92672">.</span>content))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LoginViewTestCase</span>(TestCase):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">setUp</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>client <span style="color:#f92672">=</span> Client()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>login_url <span style="color:#f92672">=</span> reverse(<span style="color:#e6db74">&#39;login&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user <span style="color:#f92672">=</span> User<span style="color:#f92672">.</span>objects<span style="color:#f92672">.</span>create_user(
</span></span><span style="display:flex;"><span>            username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>,
</span></span><span style="display:flex;"><span>            email<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser@test.com&#39;</span>,
</span></span><span style="display:flex;"><span>            password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpass&#39;</span>
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_login_view_get</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>get(self<span style="color:#f92672">.</span>login_url)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;login.html&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_login_view_post_valid_credentials</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(self<span style="color:#f92672">.</span>login_url, {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;username&#39;</span>: <span style="color:#e6db74">&#39;testuser&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;password&#39;</span>: <span style="color:#e6db74">&#39;testpass&#39;</span>,
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertRedirects(response, reverse(<span style="color:#e6db74">&#39;portfolio&#39;</span>))
</span></span><span style="display:flex;"><span>        user <span style="color:#f92672">=</span> authenticate(username<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testuser&#39;</span>, password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;testpass&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertIsNotNone(user)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(user, self<span style="color:#f92672">.</span>user)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTrue(user<span style="color:#f92672">.</span>is_authenticated)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_login_view_post_invalid_credentials</span>(self):
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>client<span style="color:#f92672">.</span>post(self<span style="color:#f92672">.</span>login_url, {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;username&#39;</span>: <span style="color:#e6db74">&#39;wronguser&#39;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;password&#39;</span>: <span style="color:#e6db74">&#39;wrongpass&#39;</span>,
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertEqual(response<span style="color:#f92672">.</span>status_code, <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertTemplateUsed(response, <span style="color:#e6db74">&#39;login.html&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>assertContains(response, <span style="color:#e6db74">&#34;Invalid username or password.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">tearDown</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>delete()
</span></span></code></pre></div><p>These are unit tests for a Django web application, testing various views in the application. Here&rsquo;s a detailed explanation of each of the views being tested and the purpose of the tests:</p>
<ol>
<li><code>LoginViewTest</code>:
<ul>
<li><code>test_login_view_with_valid_credentials</code>: This test checks if a user can successfully log in to the application with valid credentials. It sends a <code>POST</code> request to the login URL with a valid username and password, and expects to be redirected to the portfolio page (assuming successful login).</li>
<li><code>test_login_view_with_invalid_credentials</code>: This test checks if a user is unable to log in with invalid credentials. It sends a <code>POST</code> request to the login URL with an invalid username and password, and expects to receive a status code of 200 (assuming failed login) and to see an error message on the login page.</li>
</ul>
</li>
<li><code>TestAddToPortfolioView</code>:
<ul>
<li><code>test_add_to_portfolio_view_success</code>: This test checks if a user can successfully add a cryptocurrency to their portfolio. It sends a <code>POST</code> request to the add-to-portfolio URL with a valid cryptocurrency ID and quantity, and expects to be redirected to the portfolio page (assuming successful addition). It also checks if the added cryptocurrency and its details (name, symbol, quantity, and current price) have been saved in the database, and if the user&rsquo;s portfolio value has been updated accordingly.</li>
<li><code>test_add_to_portfolio_view_get_request</code>: This test checks if a user cannot add a cryptocurrency to their portfolio through a <code>GET</code> request. It sends a <code>GET</code> request to the add-to-portfolio URL and expects to receive a status code of 200 and an error message on the page.</li>
</ul>
</li>
<li><code>SearchViewTestCase</code>:
<ul>
<li><code>test_valid_search</code>: This test checks if a user can successfully search for a cryptocurrency by sending a <code>POST</code> request to the search URL with a valid search query. It expects to receive a status code of 200 and to see the cryptocurrency&rsquo;s symbol on the search results page.</li>
<li><code>test_invalid_search</code>: This test checks if a user receives an error message when searching for an invalid cryptocurrency. It sends a <code>POST</code> request to the search URL with an invalid search query and expects to receive a status code of 200 and an error message on the search results page.</li>
</ul>
</li>
<li><code>DeleteFromPortfolioViewTest</code>
<ul>
<li>This test case is testing a view called <code>DeleteFromPortfolioView</code>. The view is expected to receive a POST request with the primary key of a cryptocurrency object. The view should delete that cryptocurrency object from the database and update the user&rsquo;s portfolio value accordingly.</li>
<li>The <code>setUp</code> method creates a test client, a test user, a test cryptocurrency object, and a test portfolio object in the database.</li>
<li>The <code>test_delete_from_portfolio_view</code> method tests the view when the user is authenticated. It logs in the user using the test client, makes a POST request to the view with the primary key of the test cryptocurrency object, and asserts that the response redirects to the portfolio page. It then checks that the test cryptocurrency object no longer exists in the database and that the portfolio&rsquo;s total value is 0.</li>
<li>The <code>test_delete_from_portfolio_view_with_unauthenticated_user</code> method tests the view when the user is not authenticated. It makes a POST request to the view with the primary key of the test cryptocurrency object and asserts that the response redirects to the login page. It then checks that the test cryptocurrency object still exists in the database and that the portfolio&rsquo;s total value is still 20000.</li>
</ul>
</li>
<li><code>TestHomeView</code>
<ul>
<li>This test case is testing a view called <code>HomeView</code>. The view is expected to render a template called <code>home.html</code> and display a list of the top 10 cryptocurrencies, the user&rsquo;s cryptocurrencies, the user&rsquo;s portfolio, and the percentage changes in cryptocurrency prices.</li>
<li>The <code>setUp</code> method creates a test client, a test user, a test cryptocurrency object, and a test portfolio object in the database. It also makes a request to an external API to get the top 10 cryptocurrencies.</li>
<li>The <code>test_home_view_authenticated</code> method tests the view when the user is authenticated. It logs in the user using the test client, makes a GET request to the view, and asserts that the response status code is 200 and the correct template is used. It also checks that the response context contains the top 10 cryptocurrencies, the user&rsquo;s cryptocurrencies, the user&rsquo;s portfolio, and the percentage changes in cryptocurrency prices.</li>
<li>The <code>test_home_view_unauthenticated</code> method tests the view when the user is not authenticated. It makes a GET request to the view and asserts that the response status code is 200 and the correct template is used. It also checks that the response context contains the top 10 cryptocurrencies but does not contain the user&rsquo;s cryptocurrencies, the user&rsquo;s portfolio, or the percentage changes in cryptocurrency prices.</li>
</ul>
</li>
<li><code>SignupWithReferrerViewTestCase</code>
<ul>
<li>This test case checks the behavior of the view used for signing up with a referral code. In the <code>setUp</code>() method, a test user (referrer) is created, and the referral code is obtained from their profile.</li>
<li>The <code>test_signup_with_referrer_view_GET</code>() method sends a GET request to the view using the referral code and checks that the response status code is 200 and the <code>'signup.html</code>&rsquo; template is used.</li>
<li>The <code>test_signup_with_referrer_view_POST</code>() method sends a POST request with valid user data and the referral code. It checks that the response status code is 302, indicating a successful redirect, the User object count is 2, and the referrer of the test user is the referrer created in <code>setUp</code>(). Additionally, it checks that the bonus of the referrer is now 100, and the response redirects to the &lsquo;<code>login</code>&rsquo; view.</li>
</ul>
</li>
<li><code>SignupViewTestCase</code>
<ul>
<li>This test case checks the behavior of the view used for normal user sign up. The <code>setUp</code>() method initializes the Client object, the URL of the view, and valid user data.</li>
<li>The <code>test_signup_view_get</code>() method sends a GET request to the view and checks that the response status code is 200, the &lsquo;<code>signup.html</code>&rsquo; template is used, and the context form is of type <code>CustomUserCreationForm</code>.</li>
<li>The <code>test_signup_view_post_invalid_data</code>() method sends a POST request with invalid user data, and it checks that the response status code is 200, the &lsquo;signup.html&rsquo; template is used, and the form is of type CustomUserCreationForm. Additionally, it checks that no User objects have been created.</li>
</ul>
</li>
<li><code>LogoutViewTestCase</code>
<ul>
<li>This test case checks the behavior of the view used for user logout. The <code>setUp</code>() method initializes the Client object, creates a test user, and logs them in.</li>
<li>The <code>test_logout_view</code>() method sends a GET request to the home page and checks that the response status code is 200 and the &lsquo;24 Hour Price Changes&rsquo; element is present.</li>
<li>It then sends a GET request to the logout view and checks that the response status code is 302. Finally, it sends another GET request to the home page and checks that the response status code is 200, and the test user&rsquo;s name is not present.</li>
</ul>
</li>
<li><code>LoginViewTestCase</code>
<ul>
<li>This test case checks the behavior of the view used for user login. The <code>setUp</code>() method initializes the Client object, the URL of the view, and creates a test user. The <code>test_login_view_get</code>() method sends a GET request to the view and checks that the response status code is 200, and the <code>'login.html'</code> template is used.</li>
<li>The <code>test_login_view_post_valid_credentials</code>() method sends a POST request with valid user credentials and checks that the response is a successful redirect to the portfolio view, the user object is authenticated, and the user object is the same as the one created in <code>setUp</code>().</li>
<li>The <code>test_login_view_post_invalid_credentials</code>() method sends a POST request with invalid user credentials and checks that the response status code is 200, the &lsquo;<code>login.html</code>&rsquo; template is used, and an error message is displayed. Finally, the tearDown() method deletes the test user object.</li>
</ul>
</li>
</ol>
<h2 id="how-to-run-tests">How to Run Tests<a hidden class="anchor" aria-hidden="true" href="#how-to-run-tests">#</a></h2>
<p>All tests are written in the <code>tests.py</code> file in the <code>mainapp</code> folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># to run all tests</span>
</span></span><span style="display:flex;"><span>python manage.py test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># to run tests for a specific class</span>
</span></span><span style="display:flex;"><span>python manage.py test -k &lt;class-name&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># start coverage</span>
</span></span><span style="display:flex;"><span>coverage run --source<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;.&#39;</span> --omit<span style="color:#f92672">=</span>mainapp<span style="color:#ae81ff">\t</span>ests.py manage.py test mainapp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># generate coverage report</span>
</span></span><span style="display:flex;"><span>coverage html
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># check the htmlcov folder and open the index.html file</span>
</span></span></code></pre></div><p>






<figure>
  
    <img
      sizes="100vw"
      src="/blog/django-crypto-app/3-test1.webp"
      alt="test1"
      loading="lazy"
      >
  
  
</figure>







<figure>
  
    <img
      sizes="100vw"
      src="/blog/django-crypto-app/3-test2.webp"
      alt="test2"
      loading="lazy"
      >
  
  
</figure>







<figure>
  
    <img
      sizes="100vw"
      src="/blog/django-crypto-app/3-test3.webp"
      alt="test3"
      loading="lazy"
      >
  
  
</figure></p>
<p>






<figure>
  
    <img
      sizes="100vw"
      src="https://github.com/HighnessAtharva/django-crypto-app/raw/main/assets/coverage.png?raw=true"
      alt="coverage"
      loading="lazy"
      >
  
  
</figure></p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>This concludes the third and the final part of the series. Here we learned how to write tests for our Django project as well as the TDD approach. We saw how to write tests for models, views, and reverse urls and wrote over 60 test cases for our project achieving 90%+ test coverage.</p>
<p>This project was a great learning experience for me. I learned a lot about Django, and I also learned how to use the CoinGecko API. I also learned how to use the <code>unittest</code> module to write tests for my Django project. I hope you enjoyed reading this article. If you have any questions or suggestions, feel free to leave a comment below. Thank you for reading! 😊</p>


  </div>

  <script async data-uid="3bc620cccf" src="https://atharva-shah.ck.page/3bc620cccf/index.js"></script>
  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://atharvashah.netlify.app/tags/django/">django</a></li>
      <li><a href="https://atharvashah.netlify.app/tags/python/">python</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://atharvashah.netlify.app/posts/personal/critical-analysis-pulp-fiction/">
    <span class="title">« Prev</span>
    <br>
    <span>A Critical Analysis of Pulp Fiction</span>
  </a>
  <a class="next" href="https://atharvashah.netlify.app/posts/tech/django-crypto-app/part2/">
    <span class="title">Next »</span>
    <br>
    <span>Django Crypto App Part 2</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Django Crypto App Part 3 on twitter"
        href="https://twitter.com/intent/tweet/?text=Django%20Crypto%20App%20Part%203&amp;url=https%3a%2f%2fatharvashah.netlify.app%2fposts%2ftech%2fdjango-crypto-app%2fpart3%2f&amp;hashtags=django%2cpython">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Django Crypto App Part 3 on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fatharvashah.netlify.app%2fposts%2ftech%2fdjango-crypto-app%2fpart3%2f&amp;title=Django%20Crypto%20App%20Part%203&amp;summary=Django%20Crypto%20App%20Part%203&amp;source=https%3a%2f%2fatharvashah.netlify.app%2fposts%2ftech%2fdjango-crypto-app%2fpart3%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Django Crypto App Part 3 on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fatharvashah.netlify.app%2fposts%2ftech%2fdjango-crypto-app%2fpart3%2f&title=Django%20Crypto%20App%20Part%203">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Django Crypto App Part 3 on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fatharvashah.netlify.app%2fposts%2ftech%2fdjango-crypto-app%2fpart3%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Django Crypto App Part 3 on whatsapp"
        href="https://api.whatsapp.com/send?text=Django%20Crypto%20App%20Part%203%20-%20https%3a%2f%2fatharvashah.netlify.app%2fposts%2ftech%2fdjango-crypto-app%2fpart3%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Django Crypto App Part 3 on telegram"
        href="https://telegram.me/share/url?text=Django%20Crypto%20App%20Part%203&amp;url=https%3a%2f%2fatharvashah.netlify.app%2fposts%2ftech%2fdjango-crypto-app%2fpart3%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>
  </footer><div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-atharvashah-netlify-app" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
<div id="disqus_thread"></div>
<script type="text/javascript">
    (function() {
        
        
        if (window.location.hostname == "localhost")
            return;

        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        var disqus_shortname = 'https-atharvashah-netlify-app';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
</article>
<script>
  <!-- SCROLLING PROGRESS BAR -->
  const scrollProgress = document.getElementById('scroll-progress');
  const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;

  window.addEventListener('scroll', () => {
    const scrollTop = window.scrollY || document.documentElement.scrollTop;
    const scrollPercentage = (scrollTop / height) * 85;
    scrollProgress.style.width = `${scrollPercentage}%`;
  });
</script>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://atharvashah.netlify.app/">Atharva Shah</a></span> 
    
    |<span><a href="/privacy-policy/" target="_blank">Privacy Policy</a></span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="AtharvaShah" data-description="Support me on Buy me a coffee!" data-message="Every bit of support counts!" data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>


<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function() {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function(e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });
</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function() {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };
</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })
</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) {};
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script></body>

</html>
